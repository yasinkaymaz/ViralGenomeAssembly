#!/bin/bash

#form=isoforms
form=genes

toolDir='/home/yk42w/codes/ViralGenomeAssembly'

#Merge RSEM output files:
utils=/n/home13/yasinkaymaz/codes/utils

for value in TPM;do
$toolDir/utils/merge_Kallisto-outputs_single_table_${value}.pl \
kallisto.eBL01_1_PolyA-RNA_EBV/eBL01_1_PolyA-RNA \
kallisto.eBL01_1_TotalRNA_EBV/eBL01_1_TotalRNA \
kallisto.eBL01_2_PolyA-RNA_EBV/eBL01_2_PolyA-RNA \
kallisto.eBL01_2_TotalRNA_EBV/eBL01_2_TotalRNA \
kallisto.eBL01P_1_TotalRNA_EBV/eBL01P_1_TotalRNA \
kallisto.eBL01P_2_TotalRNA_EBV/eBL01P_2_TotalRNA \
kallisto.eBL02_1_PolyA-RNA_EBV/eBL02_1_PolyA-RNA \
kallisto.eBL02_1_TotalRNA_EBV/eBL02_1_TotalRNA \
kallisto.eBL02_2_PolyA-RNA_EBV/eBL02_2_PolyA-RNA \
kallisto.eBL02_2_TotalRNA_EBV/eBL02_2_TotalRNA \
kallisto.eBL02P_1_TotalRNA_EBV/eBL02P_1_TotalRNA \
kallisto.eBL02P_2_TotalRNA_EBV/eBL02P_2_TotalRNA \
kallisto.eBL03_1_PolyA-RNA_EBV/eBL03_1_PolyA-RNA \
kallisto.eBL03_1_TotalRNA_EBV/eBL03_1_TotalRNA \
kallisto.eBL03_2_PolyA-RNA_EBV/eBL03_2_PolyA-RNA \
kallisto.eBL03_2_TotalRNA_EBV/eBL03_2_TotalRNA \
kallisto.eBL03P_1_TotalRNA_EBV/eBL03P_1_TotalRNA \
kallisto.eBL03P_2_TotalRNA_EBV/eBL03P_2_TotalRNA \
kallisto.eBL04_1_PolyA-RNA_EBV/eBL04_1_PolyA-RNA \
kallisto.eBL04_1_TotalRNA_EBV/eBL04_1_TotalRNA \
kallisto.eBL04_2_PolyA-RNA_EBV/eBL04_2_PolyA-RNA \
kallisto.eBL04_2_TotalRNA_EBV/eBL04_2_TotalRNA \
kallisto.eBL04P_1_TotalRNA_EBV/eBL04P_1_TotalRNA \
kallisto.eBL04P_2_TotalRNA_EBV/eBL04P_2_TotalRNA \
kallisto.eBL05_1_PolyA-RNA_EBV/eBL05_1_PolyA-RNA \
kallisto.eBL05_1_TotalRNA_EBV/eBL05_1_TotalRNA \
kallisto.eBL05_2_PolyA-RNA_EBV/eBL05_2_PolyA-RNA \
kallisto.eBL05_2_TotalRNA_EBV/eBL05_2_TotalRNA \
kallisto.eBL06_1_PolyA-RNA_EBV/eBL06_1_PolyA-RNA \
kallisto.eBL06_1_TotalRNA_EBV/eBL06_1_TotalRNA \
kallisto.eBL06_2_PolyA-RNA_EBV/eBL06_2_PolyA-RNA \
kallisto.eBL06_2_TotalRNA_EBV/eBL06_2_TotalRNA \
kallisto.eBL07_1_PolyA-RNA_EBV/eBL07_1_PolyA-RNA \
kallisto.eBL07_1_TotalRNA_EBV/eBL07_1_TotalRNA \
kallisto.eBL07_2_PolyA-RNA_EBV/eBL07_2_PolyA-RNA \
kallisto.eBL07_2_TotalRNA_EBV/eBL07_2_TotalRNA \
kallisto.eBL08_1_PolyA-RNA_EBV/eBL08_1_PolyA-RNA \
kallisto.eBL08_1_TotalRNA_EBV/eBL08_1_TotalRNA \
kallisto.eBL08_2_PolyA-RNA_EBV/eBL08_2_PolyA-RNA \
kallisto.eBL08_2_TotalRNA_EBV/eBL08_2_TotalRNA \
kallisto.eBL09_1_PolyA-RNA_EBV/eBL09_1_PolyA-RNA \
kallisto.eBL09_1_TotalRNA_EBV/eBL09_1_TotalRNA \
kallisto.eBL09_2_PolyA-RNA_EBV/eBL09_2_PolyA-RNA \
kallisto.eBL09_2_TotalRNA_EBV/eBL09_2_TotalRNA \
kallisto.eBL10_1_PolyA-RNA_EBV/eBL10_1_PolyA-RNA \
kallisto.eBL10_1_TotalRNA_EBV/eBL10_1_TotalRNA \
kallisto.eBL10_2_PolyA-RNA_EBV/eBL10_2_PolyA-RNA \
kallisto.eBL10_2_TotalRNA_EBV/eBL10_2_TotalRNA \
kallisto.eBL11_1_PolyA-RNA_EBV/eBL11_1_PolyA-RNA \
kallisto.eBL11_1_TotalRNA_EBV/eBL11_1_TotalRNA \
kallisto.eBL11_2_PolyA-RNA_EBV/eBL11_2_PolyA-RNA \
kallisto.eBL11_2_TotalRNA_EBV/eBL11_2_TotalRNA \
kallisto.eBL12_1_PolyA-RNA_EBV/eBL12_1_PolyA-RNA \
kallisto.eBL12_1_TotalRNA_EBV/eBL12_1_TotalRNA \
kallisto.eBL12_2_PolyA-RNA_EBV/eBL12_2_PolyA-RNA \
kallisto.eBL12_2_TotalRNA_EBV/eBL12_2_TotalRNA \
kallisto.eBL13_1_PolyA-RNA_EBV/eBL13_1_PolyA-RNA \
kallisto.eBL13_1_TotalRNA_EBV/eBL13_1_TotalRNA \
kallisto.eBL13_2_PolyA-RNA_EBV/eBL13_2_PolyA-RNA \
kallisto.eBL13_2_TotalRNA_EBV/eBL13_2_TotalRNA \
kallisto.eBL14_1_PolyA-RNA_EBV/eBL14_1_PolyA-RNA \
kallisto.eBL14_1_TotalRNA_EBV/eBL14_1_TotalRNA \
kallisto.eBL14_2_PolyA-RNA_EBV/eBL14_2_PolyA-RNA \
kallisto.eBL14_2_TotalRNA_EBV/eBL14_2_TotalRNA \
kallisto.eBL17_1_TotalRNA_EBV/eBL17_1_TotalRNA \
kallisto.eBL17_2_TotalRNA_EBV/eBL17_2_TotalRNA \
kallisto.eBL19_1_PolyA-RNA_EBV/eBL19_1_PolyA-RNA \
kallisto.eBL19_1_TotalRNA_EBV/eBL19_1_TotalRNA \
kallisto.eBL19_2_PolyA-RNA_EBV/eBL19_2_PolyA-RNA \
kallisto.eBL19_2_TotalRNA_EBV/eBL19_2_TotalRNA \
kallisto.eBL20_1_PolyA-RNA_EBV/eBL20_1_PolyA-RNA \
kallisto.eBL20_1_TotalRNA_EBV/eBL20_1_TotalRNA \
kallisto.eBL20_2_PolyA-RNA_EBV/eBL20_2_PolyA-RNA \
kallisto.eBL20_2_TotalRNA_EBV/eBL20_2_TotalRNA \
kallisto.eBL21_1_PolyA-RNA_EBV/eBL21_1_PolyA-RNA \
kallisto.eBL21_1_TotalRNA_EBV/eBL21_1_TotalRNA \
kallisto.eBL21_2_PolyA-RNA_EBV/eBL21_2_PolyA-RNA \
kallisto.eBL21_2_TotalRNA_EBV/eBL21_2_TotalRNA \
kallisto.eBL22_1_PolyA-RNA_EBV/eBL22_1_PolyA-RNA \
kallisto.eBL22_1_TotalRNA_EBV/eBL22_1_TotalRNA \
kallisto.eBL22_2_PolyA-RNA_EBV/eBL22_2_PolyA-RNA \
kallisto.eBL22_2_TotalRNA_EBV/eBL22_2_TotalRNA \
kallisto.eBL23_1_PolyA-RNA_EBV/eBL23_1_PolyA-RNA \
kallisto.eBL23_1_TotalRNA_EBV/eBL23_1_TotalRNA \
kallisto.eBL23_2_PolyA-RNA_EBV/eBL23_2_PolyA-RNA \
kallisto.eBL23_2_TotalRNA_EBV/eBL23_2_TotalRNA \
kallisto.eBL24_1_PolyA-RNA_EBV/eBL24_1_PolyA-RNA \
kallisto.eBL24_1_TotalRNA_EBV/eBL24_1_TotalRNA \
kallisto.eBL24_2_PolyA-RNA_EBV/eBL24_2_PolyA-RNA \
kallisto.eBL24_2_TotalRNA_EBV/eBL24_2_TotalRNA \
kallisto.eBL25_1_PolyA-RNA_EBV/eBL25_1_PolyA-RNA \
kallisto.eBL25_1_TotalRNA_EBV/eBL25_1_TotalRNA \
kallisto.eBL25_2_PolyA-RNA_EBV/eBL25_2_PolyA-RNA \
kallisto.eBL25_2_TotalRNA_EBV/eBL25_2_TotalRNA \
kallisto.eBL26_1_PolyA-RNA_EBV/eBL26_1_PolyA-RNA \
kallisto.eBL26_1_TotalRNA_EBV/eBL26_1_TotalRNA \
kallisto.eBL26_2_PolyA-RNA_EBV/eBL26_2_PolyA-RNA \
kallisto.eBL26_2_TotalRNA_EBV/eBL26_2_TotalRNA \
kallisto.eBL27_1_PolyA-RNA_EBV/eBL27_1_PolyA-RNA \
kallisto.eBL27_1_TotalRNA_EBV/eBL27_1_TotalRNA \
kallisto.eBL27_2_PolyA-RNA_EBV/eBL27_2_PolyA-RNA \
kallisto.eBL27_2_TotalRNA_EBV/eBL27_2_TotalRNA \
kallisto.eBL28_1_PolyA-RNA_EBV/eBL28_1_PolyA-RNA \
kallisto.eBL28_1_TotalRNA_EBV/eBL28_1_TotalRNA \
kallisto.eBL28_2_PolyA-RNA_EBV/eBL28_2_PolyA-RNA \
kallisto.eBL28_2_TotalRNA_EBV/eBL28_2_TotalRNA \
kallisto.eBL29_1_PolyA-RNA_EBV/eBL29_1_PolyA-RNA \
kallisto.eBL29_1_TotalRNA_EBV/eBL29_1_TotalRNA \
kallisto.eBL29_2_PolyA-RNA_EBV/eBL29_2_PolyA-RNA \
kallisto.eBL29_2_TotalRNA_EBV/eBL29_2_TotalRNA \
kallisto.eBL30_1_PolyA-RNA_EBV/eBL30_1_PolyA-RNA \
kallisto.eBL30_1_TotalRNA_EBV/eBL30_1_TotalRNA \
kallisto.eBL30_2_PolyA-RNA_EBV/eBL30_2_PolyA-RNA \
kallisto.eBL30_2_TotalRNA_EBV/eBL30_2_TotalRNA \
kallisto.eBL31_1_PolyA-RNA_EBV/eBL31_1_PolyA-RNA \
kallisto.eBL31_1_TotalRNA_EBV/eBL31_1_TotalRNA \
kallisto.eBL31_2_PolyA-RNA_EBV/eBL31_2_PolyA-RNA \
kallisto.eBL31_2_TotalRNA_EBV/eBL31_2_TotalRNA \
kallisto.eBL32_1_PolyA-RNA_EBV/eBL32_1_PolyA-RNA \
kallisto.eBL32_1_TotalRNA_EBV/eBL32_1_TotalRNA \
kallisto.eBL32_2_PolyA-RNA_EBV/eBL32_2_PolyA-RNA \
kallisto.eBL32_2_TotalRNA_EBV/eBL32_2_TotalRNA \
kallisto.eBL33_1_PolyA-RNA_EBV/eBL33_1_PolyA-RNA \
kallisto.eBL33_1_TotalRNA_EBV/eBL33_1_TotalRNA \
kallisto.eBL33_2_PolyA-RNA_EBV/eBL33_2_PolyA-RNA \
kallisto.eBL33_2_TotalRNA_EBV/eBL33_2_TotalRNA \
kallisto.eBL34_1_PolyA-RNA_EBV/eBL34_1_PolyA-RNA \
kallisto.eBL34_1_TotalRNA_EBV/eBL34_1_TotalRNA \
kallisto.eBL34_2_PolyA-RNA_EBV/eBL34_2_PolyA-RNA \
kallisto.eBL34_2_TotalRNA_EBV/eBL34_2_TotalRNA \
kallisto.eBL35_1_PolyA-RNA_EBV/eBL35_1_PolyA-RNA \
kallisto.eBL35_1_TotalRNA_EBV/eBL35_1_TotalRNA \
kallisto.eBL35_2_PolyA-RNA_EBV/eBL35_2_PolyA-RNA \
kallisto.eBL35_2_TotalRNA_EBV/eBL35_2_TotalRNA \
kallisto.eBL36_1_PolyA-RNA_EBV/eBL36_1_PolyA-RNA \
kallisto.eBL36_1_TotalRNA_EBV/eBL36_1_TotalRNA \
kallisto.eBL36_2_PolyA-RNA_EBV/eBL36_2_PolyA-RNA \
kallisto.eBL36_2_TotalRNA_EBV/eBL36_2_TotalRNA \
kallisto.eBL37_1_PolyA-RNA_EBV/eBL37_1_PolyA-RNA \
kallisto.eBL37_1_TotalRNA_EBV/eBL37_1_TotalRNA \
kallisto.eBL37_2_PolyA-RNA_EBV/eBL37_2_PolyA-RNA \
kallisto.eBL37_2_TotalRNA_EBV/eBL37_2_TotalRNA \
kallisto.eBL38_1_PolyA-RNA_EBV/eBL38_1_PolyA-RNA \
kallisto.eBL38_1_TotalRNA_EBV/eBL38_1_TotalRNA \
kallisto.eBL38_2_PolyA-RNA_EBV/eBL38_2_PolyA-RNA \
kallisto.eBL38_2_TotalRNA_EBV/eBL38_2_TotalRNA \
kallisto.eBL39_1_PolyA-RNA_EBV/eBL39_1_PolyA-RNA \
kallisto.eBL39_1_TotalRNA_EBV/eBL39_1_TotalRNA \
kallisto.eBL39_2_PolyA-RNA_EBV/eBL39_2_PolyA-RNA \
kallisto.eBL39_2_TotalRNA_EBV/eBL39_2_TotalRNA \
kallisto.eBL42_1_PolyA-RNA_EBV/eBL42_1_PolyA-RNA \
kallisto.eBL42_1_TotalRNA_EBV/eBL42_1_TotalRNA \
kallisto.eBL42_2_PolyA-RNA_EBV/eBL42_2_PolyA-RNA \
kallisto.eBL42_2_TotalRNA_EBV/eBL42_2_TotalRNA \
kallisto.eBL44_1_PolyA-RNA_EBV/eBL44_1_PolyA-RNA \
kallisto.eBL44_2_PolyA-RNA_EBV/eBL44_2_PolyA-RNA \
kallisto.eBL45_1_TotalRNA_EBV/eBL45_1_TotalRNA \
kallisto.eBL45_2_TotalRNA_EBV/eBL45_2_TotalRNA \
kallisto.eBL46_1_TotalRNA_EBV/eBL46_1_TotalRNA \
kallisto.eBL46_2_TotalRNA_EBV/eBL46_2_TotalRNA \
kallisto.eBL47_1_PolyA-RNA_EBV/eBL47_1_PolyA-RNA \
kallisto.eBL47_1_TotalRNA_EBV/eBL47_1_TotalRNA \
kallisto.eBL47_2_PolyA-RNA_EBV/eBL47_2_PolyA-RNA \
kallisto.eBL47_2_TotalRNA_EBV/eBL47_2_TotalRNA \
kallisto.eBL48_1_PolyA-RNA_EBV/eBL48_1_PolyA-RNA \
kallisto.eBL48_1_TotalRNA_EBV/eBL48_1_TotalRNA \
kallisto.eBL48_2_PolyA-RNA_EBV/eBL48_2_PolyA-RNA \
kallisto.eBL48_2_TotalRNA_EBV/eBL48_2_TotalRNA \
> merged.kallisto.expression_${value}.txt

#awk 'FNR==NR{a[substr($1,1,15)]=$1;next}{print $0"\t", a[$1]}' /n/home13/yasinkaymaz/LabSpace/References/GRCh38/Transcripts_GeneSymbol_mapping.txt /n/home13/yasinkaymaz/LabSpace/results/test/merged.kallisto.expression_${value}.txt > ~/merged.kallisto.expression_"${value}"_geneIds.txt
#Rscript /n/home13/yasinkaymaz/codes/scRNAseqPipe/MergeTranscriptsToGenes.R ~/merged.kallisto.expression_"${value}"_geneIds.txt
#cat /n/home13/yasinkaymaz/LabSpace/results/test/merged.kallisto.expression_${value}.txt|sed 's/scRNAseq_paired_//g'|sed 's/.genes.results//g'|cut -d "_" -f2- > /n/home13/yasinkaymaz/LabSpace/results/test/Merged.kallisto.Expression_${value}.txt
echo "...";
done
#rm /n/home13/yasinkaymaz/LabSpace/results/test/merged.rsem.expression*
